<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What is Binary? + Binary Game</title>
    <script src="../constants.js"></script>
    <script src="../navigation.js"></script>
    <style>
        /* Matrix Hacker Theme CSS */
        body {
            min-height: 100vh;
            background: #0f2027;
            background: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
            color: #00ff41;
            font-family: 'Fira Mono', 'Consolas', 'Menlo', monospace;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        h1, h2, h3, p, th, td, label {
            color: #00ff41;
            text-shadow: 0 0 8px #00ff41, 0 0 2px #000;
        }
        
        table {
            background: rgba(0,0,0,0.85);
            border-radius: 8px;
            box-shadow: 0 0 24px #00ff4160;
            border-collapse: collapse;
            margin-bottom: 32px;
        }
        
        th, td {
            border: 1px solid #00ff41;
            padding: 8px 16px;
            font-size: 1.1em;
        }
        
        input[type="text"] {
            background: #111;
            color: #00ff41;
            border: 1.5px solid #00ff41;
            border-radius: 4px;
            font-size: 1.3em;
            padding: 8px 12px;
            margin: 0 8px;
            outline: none;
            box-shadow: 0 0 8px #00ff4140;
            transition: border 0.2s, box-shadow 0.2s;
        }
        
        input[type="text"]:focus {
            border: 1.5px solid #fff;
            box-shadow: 0 0 16px #00ff41;
        }
        
        button {
            background: #00ff41;
            color: #111;
            border: none;
            border-radius: 4px;
            font-size: 1.2em;
            font-family: inherit;
            padding: 10px 28px;
            margin: 0 8px;
            cursor: pointer;
            box-shadow: 0 0 8px #00ff41;
            transition: background 0.2s, color 0.2s;
        }
        
        button:hover {
            background: #111;
            color: #00ff41;
            border: 1.5px solid #00ff41;
        }
        
        #feedback-message {
            font-size: 1.2em;
            margin-top: 18px;
            text-shadow: 0 0 8px #00ff41;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            background: #111;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #00ff41;
            border-radius: 4px;
        }
        
        /* Section navigation styles */
        .section { 
            display: none; 
        }
        
        .section.active { 
            display: block; 
        }
        
        .next-arrow {
            display: flex;
            justify-content: center;
            margin-top: 32px;
        }
        
        .next-btn {
            background: none;
            border: none;
            color: #00ff41;
            font-size: 2.5em;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .next-btn:hover { 
            color: #fff200; 
        }
        
        .hidden {
            display: none;
        }
        
        /* Modal styles */
        .matrix-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .matrix-modal-content {
            background: rgba(15, 32, 39, 0.95);
            border: 2px solid #00ff41;
            border-radius: 8px;
            padding: 32px;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 0 32px #00ff41;
        }
        
        .matrix-modal h2 {
            margin-top: 0;
            color: #00ff41;
            text-shadow: 0 0 8px #00ff41;
        }
        
        .matrix-modal p {
            color: #00ff41;
            font-size: 1.1em;
            margin: 16px 0;
        }
        
        .matrix-modal button {
            margin-top: 16px;
        }
    </style>
</head>
<body>
    <!-- What is Binary Section -->
    <div class="section active" id="section-binary-info">
        <div style="max-width: 700px; margin: 48px auto; background: rgba(0,0,0,0.85); border-radius: 12px; box-shadow: 0 0 24px #00ff4140; padding: 32px;">
            <h1 style="text-align:center;">What is Binary?</h1>
            <p>Binary is a way of representing information using only two options: 0 and 1. It's the language computers use to store and process all data, from text and images to music and video.</p>
            <h2>Why 0 and 1?</h2>
            <p>Computers are made of tiny switches that can be either <b>off</b> (0) or <b>on</b> (1). By combining lots of these switches, computers can represent any number, letter, or symbol.</p>
            <h2>How does it work?</h2>
            <ul>
                <li>Each digit in a binary number is called a <b>bit</b>.</li>
                <li>8 bits make a <b>byte</b>, which can represent 256 different values (from 0 to 255).</li>
                <li>For example, the letter <b>A</b> is 65 in decimal, but <b>01000001</b> in binary.</li>
            </ul>
            <h2>Binary vs. Decimal</h2>
            <p>We use decimal (base 10) in everyday life, but computers use binary (base 2):</p>
            <table style="margin: 0 auto;">
                <tr><th>Decimal</th><th>Binary</th></tr>
                <tr><td>0</td><td>0</td></tr>
                <tr><td>1</td><td>1</td></tr>
                <tr><td>2</td><td>10</td></tr>
                <tr><td>3</td><td>11</td></tr>
                <tr><td>4</td><td>100</td></tr>
                <tr><td>5</td><td>101</td></tr>
                <tr><td>6</td><td>110</td></tr>
                <tr><td>7</td><td>111</td></tr>
                <tr><td>8</td><td>1000</td></tr>
            </table>
            <p>Every photo, song, and message on your computer is just a long string of 0s and 1s!</p>
            <div class="next-arrow">
                <button class="next-btn" id="to-binary-game" title="Next: Binary Game">&#8594;</button>
            </div>
        </div>
    </div>

    <!-- Binary Game Section -->
    <div class="section" id="section-binary-game">
        <div style="width: 100%; display: flex; flex-direction: column; align-items: center;">
            <table>
                <thead>
                    <tr>
                        <th>Character</th>
                        <th>Binary</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>A</td><td>01000001</td></tr>
                    <tr><td>B</td><td>01000010</td></tr>
                    <tr><td>C</td><td>01000011</td></tr>
                    <tr><td>D</td><td>01000100</td></tr>
                    <tr><td>E</td><td>01000101</td></tr>
                    <tr><td>F</td><td>01000110</td></tr>
                    <tr><td>G</td><td>01000111</td></tr>
                    <tr><td>H</td><td>01001000</td></tr>
                    <tr><td>I</td><td>01001001</td></tr>
                    <tr><td>J</td><td>01001010</td></tr>
                    <tr><td>K</td><td>01001011</td></tr>
                    <tr><td>L</td><td>01001100</td></tr>
                    <tr><td>M</td><td>01001101</td></tr>
                    <tr><td>N</td><td>01001110</td></tr>
                    <tr><td>O</td><td>01001111</td></tr>
                    <tr><td>P</td><td>01010000</td></tr>
                    <tr><td>Q</td><td>01010001</td></tr>
                    <tr><td>R</td><td>01010010</td></tr>
                    <tr><td>S</td><td>01010011</td></tr>
                    <tr><td>T</td><td>01010100</td></tr>
                    <tr><td>U</td><td>01010101</td></tr>
                    <tr><td>V</td><td>01010110</td></tr>
                    <tr><td>W</td><td>01010111</td></tr>
                    <tr><td>X</td><td>01011000</td></tr>
                    <tr><td>Y</td><td>01011001</td></tr>
                    <tr><td>Z</td><td>01011010</td></tr>
                    <tr><td>0</td><td>00110000</td></tr>
                    <tr><td>1</td><td>00110001</td></tr>
                    <tr><td>2</td><td>00110010</td></tr>
                    <tr><td>3</td><td>00110011</td></tr>
                    <tr><td>4</td><td>00110100</td></tr>
                    <tr><td>5</td><td>00110101</td></tr>
                    <tr><td>6</td><td>00110110</td></tr>
                    <tr><td>7</td><td>00110111</td></tr>
                    <tr><td>8</td><td>00111000</td></tr>
                    <tr><td>9</td><td>00111001</td></tr>
                </tbody>
            </table>
            <div style="display: flex; flex-direction: column; align-items: center; margin-top: 24px;">
                <div style="margin-bottom: 8px; text-align: center;">
                    <p style="margin: 0;">Decode the binary message below:</p>
                    <p style="font-family: monospace; font-size: 1.2em; margin: 0;">01000010 01001001 01010100</p>
                    <p id="binary-question" style="margin: 0;"></p>
                </div>
                <div style="display: flex; gap: 18px; justify-content: center;">
                    <input type="text" id="input1" maxlength="1">
                    <input type="text" id="input2" maxlength="1">
                    <input type="text" id="input3" maxlength="1">
                </div>
            </div>
            <div style="display: flex; justify-content: center; margin-top: 16px; width: 100%;">
                <button id="check-btn">Check Answer</button>
            </div>
            <p id="feedback-message" class="hidden" style="text-align: center;"></p>
            <div style="display: flex; justify-content: center; margin-top: 12px; padding-bottom: 40px;">
                <button id="next-level-btn" style="display:none;" class="hidden" onclick="showNextPasswordModal()">Next Level</button>
            </div>
        </div>
    </div>

    <script>
        // Modal functionality
        function showMatrixModal(options) {
            const modal = document.createElement('div');
            modal.className = 'matrix-modal';
            modal.innerHTML = `
                <div class="matrix-modal-content">
                    <h2>${options.title || 'Modal'}</h2>
                    <p>${options.message || ''}</p>
                    <button onclick="closeModal()">${options.buttonText || 'Close'}</button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            window.closeModal = function() {
                document.body.removeChild(modal);
                if (options.onClose) {
                    options.onClose();
                }
            };
        }
        
        // Expose showNextPasswordModal globally for the Next Level button
        window.showNextPasswordModal = function() {
            console.log('[DEBUG] showNextPasswordModal called');
            console.log('Getting dynamic password for Binary completion...');
            
            let password = 'BINARY_COMPLETE'; // fallback
            
            try {
                const info = window.getLevelInfo('Binary/index.html');
                console.log('Level info:', info);
                if (info && info.next) {
                    console.log('Next password from constants.js:', info.next.password);
                    password = info.next.password;
                }
            } catch (error) {
                console.error('Error getting level info:', error);
            }
            
            if (typeof showMatrixModal === 'function') {
                console.log('[DEBUG] showMatrixModal is a function, showing modal with password:', password);
                showMatrixModal({
                    title: 'Level Password',
                    message: 'The password is: <b style="color:#00ff41;">' + password + '</b>',
                    buttonText: 'OK',
                    onClose: function() {
                        console.log('[DEBUG] Matrix modal closed, redirecting to PasswordPortal');
                        goToNextPage();
                    }
                });
            } else {
                console.warn('[DEBUG] showMatrixModal is not a function, falling back to alert. Password:', password);
                alert('The password is: ' + password);
            }
        };
        
        // Game logic
        // For 3 input fields, the correct answer is 'B', 'I', 'T' (from the binary message)
        const correctAnswer = ['B', 'I', 'T'];
        
        // Function to check if the input matches the correct answer
        function checkAnswer() {
            let userAnswer = [];
            const allowed = ['B', 'I', 'T'];
            const feedbackMessage = document.getElementById("feedback-message");
            
            for (let i = 1; i <= 3; i++) {
                const inputElem = document.getElementById('input' + i);
                if (!inputElem) {
                    alert('Input box #' + i + ' is missing from the page.');
                    return;
                }
                const val = inputElem.value.trim().toUpperCase();
                if (val.length === 0 || !allowed.includes(val)) {
                    feedbackMessage.textContent = "Incorrect. Try Again.";
                    feedbackMessage.style.color = "red";
                    feedbackMessage.classList.remove("hidden");
                    return;
                }
                userAnswer.push(val);
            }
            
            const nextLevelButton = document.getElementById("next-level-btn");
            if (JSON.stringify(userAnswer) === JSON.stringify(correctAnswer)) {
                feedbackMessage.textContent = "Correct! Well done!";
                feedbackMessage.style.color = "#00ff41";
                feedbackMessage.classList.remove("hidden");
                if (nextLevelButton) {
                    nextLevelButton.style.display = "inline-block";
                    nextLevelButton.classList.remove("hidden");
                }
            } else {
                feedbackMessage.textContent = "Incorrect. Try Again.";
                feedbackMessage.style.color = "red";
                feedbackMessage.classList.remove("hidden");
                if (nextLevelButton) {
                    nextLevelButton.style.display = "none";
                    nextLevelButton.classList.add("hidden");
                }
            }
        }
        
        // Section navigation
        document.getElementById('to-binary-game').onclick = function() {
            document.getElementById('section-binary-info').classList.remove('active');
            document.getElementById('section-binary-game').classList.add('active');
        };
        
        // Prevent Ctrl+F and Cmd+F (browser find)
        window.addEventListener('keydown', function (e) {
            if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'f') {
                e.preventDefault();
                alert('Are you trying to Ctrl-F?');
            }
        });
        
        // Bind the check button to the checkAnswer function
        document.getElementById('check-btn').addEventListener('click', checkAnswer);
        
        // Allow inputs to accept uppercase automatically
        for (let i = 1; i <= 3; i++) {
            document.getElementById('input' + i).addEventListener('input', function(e) {
                e.target.value = e.target.value.toUpperCase();
            });
        }
    </script>
</body>
</html>